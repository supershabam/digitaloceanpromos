<!DOCTYPE html>
<script src="//use.typekit.net/grm4nxy.js"></script>
<script>try{Typekit.load();}catch(e){}</script>
<style>
body, html { 
  font-family: proxima-nova, sans-serif;
  font-size: 13px;
  background-color: #368eca;
  color: white;
  height: 100%;
  margin: 0 auto;
}
#zach {
  position: absolute;
}
#promo {
  background: #215f8b;
  position: absolute;
  border: 1px solid #dadada;
  font-size: 14px;
  font-weight: 400;
  letter-spacing: 1.5px;
  padding: 10px 11px;
}
</style>
<img id="zach" src="https://www.digitalocean.com/assets/images/employees/zach_bouzan-kaloustian-eff91e4b.png" />
<span id="promo">CLICK FOR PROMO CODE</span>
<script>
  var zach = document.getElementById('zach')
  var promo = document.getElementById('promo')

  // mouse locations
  var mx = 0, my = 0
  document.addEventListener('mousemove', function(e) {
    mx = e.clientX
    my = e.clientY
  })

  function step(t) {
    moveZach(t)
    movePromo(t)
    window.requestAnimationFrame(step)
  }
  
  function movePromo(t) {
    // window width and height
    var ww = window.innerWidth
    var wh = window.innerHeight
    var w = promo.offsetWidth
    var h = promo.offsetHeight
    var cx = ww / 2
    var cy = wh / 2
    // by default center the element
    var x = cx
    var y = cy

    // defense circle
    var radius = w
    var dx = cx - mx
    var dy = cy - my
    var l = Math.sqrt(dx * dx, dy * dy)
    if (l < radius) {
      var angle = Math.atan2(dy, dx)
      var m = (radius - l) / radius
      x = x + m * m * m * 5 * w * Math.cos(angle)
      y = y + m * m * m * 15 * h * Math.sin(angle)
    }

    promo.style.transform = 'translate(' + (x - w/2) + 'px,' + (y - h/2) + 'px)'
  }

  function moveZach(t) {
    // window width and height
    var ww = window.innerWidth
    var wh = window.innerHeight
  
    // image width and height
    var w = zach.offsetWidth
    var h = zach.offsetHeight
  
    // rotate
    var r = t / 2.5
  
    // get x y from interesting parametric equation
    var speed = 0.004 + 0.00 * (Math.sin(t/1000) + 1)
    var vx = 11 * Math.cos(t * speed) - 6 * Math.cos(11/6 * t * speed)
    var vy = 11 * Math.sin(t * speed) - 6 * Math.sin(11/6 * t * speed)
    // unit vector the result
    var norm = Math.sqrt(vx * vx + vy * vy)
    ux = vx / norm
    uy = vy / norm
    // project ux and uy onto 3/4 of available window
    x = ((ux + 1) / 2) * (3/4 * ww) + (1/8 * ww) - (1/2 * w)
    y = ((uy + 1) / 2) * // percentage of y from [0,1]
        (3/4 * wh) +     // times available height pixels
        (1/8 * wh) -     // center ourselves within the height
        (1/2 * h)        // offset to center of zach image

    zach.style.transform = 'translate(' + x + 'px,' + y + 'px) rotate(' + r + 'deg)'

  }
  window.requestAnimationFrame(step)
</script>
